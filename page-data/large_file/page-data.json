{"componentChunkName":"component---src-templates-post-template-tsx","path":"/large_file/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4ad5fb66bf8fd7d5069873bd05a8e032/63217/large_file.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAQP/xAAVAQEBAAAAAAAAAAAAAAAAAAACAf/aAAwDAQACEAMQAAABrLdEkbJgb//EABoQAQACAwEAAAAAAAAAAAAAAAIBAwAREiH/2gAIAQEAAQUCs6mRucPpvUhG7BGh/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Bh//EABoQAAICAwAAAAAAAAAAAAAAAAABESExQWH/2gAIAQEABj8ChPRVdEyZyhiR/8QAHRABAQABBAMAAAAAAAAAAAAAAREAITFBYVFx0f/aAAgBAQABPyGiolQ5yuEnVHHXeNW3QcFheAmJsE9T5moVga5//9oADAMBAAIAAwAAABD8H//EABcRAAMBAAAAAAAAAAAAAAAAAAEQESH/2gAIAQMBAT8QMur/xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QEmk//8QAGxABAQADAQEBAAAAAAAAAAAAAREAITFRcaH/2gAIAQEAAT8QRSCbR3SWUdGMS0lofSEi7tzqgz6mRlYaER7UffzJ91VbNfXCMNmol1n/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4ad5fb66bf8fd7d5069873bd05a8e032/a59e9/large_file.webp 192w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/0ca9f/large_file.webp 384w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/dc9b9/large_file.webp 768w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/d71bc/large_file.webp 1024w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4ad5fb66bf8fd7d5069873bd05a8e032/150b2/large_file.jpg 192w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/6985d/large_file.jpg 384w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/19de6/large_file.jpg 768w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/63217/large_file.jpg 1024w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4ad5fb66bf8fd7d5069873bd05a8e032/19de6/large_file.jpg\"\n            alt=\"Thumbnail image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<div class=\"img_wrapper\">\n  <p class=\"md_img\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/4ad5fb66bf8fd7d5069873bd05a8e032/63217/large_file.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAQP/xAAVAQEBAAAAAAAAAAAAAAAAAAACAf/aAAwDAQACEAMQAAABrLdEkbJgb//EABoQAQACAwEAAAAAAAAAAAAAAAIBAwAREiH/2gAIAQEAAQUCs6mRucPpvUhG7BGh/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Bh//EABoQAAICAwAAAAAAAAAAAAAAAAABESExQWH/2gAIAQEABj8ChPRVdEyZyhiR/8QAHRABAQABBAMAAAAAAAAAAAAAAREAITFBYVFx0f/aAAgBAQABPyGiolQ5yuEnVHHXeNW3QcFheAmJsE9T5moVga5//9oADAMBAAIAAwAAABD8H//EABcRAAMBAAAAAAAAAAAAAAAAAAEQESH/2gAIAQMBAT8QMur/xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QEmk//8QAGxABAQADAQEBAAAAAAAAAAAAAREAITFRcaH/2gAIAQEAAT8QRSCbR3SWUdGMS0lofSEi7tzqgz6mRlYaER7UffzJ91VbNfXCMNmol1n/2Q=='); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/4ad5fb66bf8fd7d5069873bd05a8e032/a59e9/large_file.webp 192w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/0ca9f/large_file.webp 384w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/dc9b9/large_file.webp 768w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/d71bc/large_file.webp 1024w\" sizes=\"(max-width: 768px) 100vw, 768px\" type=\"image/webp\">\n          <source srcset=\"/static/4ad5fb66bf8fd7d5069873bd05a8e032/150b2/large_file.jpg 192w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/6985d/large_file.jpg 384w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/19de6/large_file.jpg 768w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/63217/large_file.jpg 1024w\" sizes=\"(max-width: 768px) 100vw, 768px\" type=\"image/jpeg\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/4ad5fb66bf8fd7d5069873bd05a8e032/19de6/large_file.jpg\" alt=\"large file\" title=\"\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span>\n  </p>\n</div>\n<p>웹 개발을 하다보면 파일 업로드가 필요한 경우가 있습니다. <br />\n이때 파일의 크기가 커지면 업로드 시간이 길어지고, 네트워크 오류나 서버 부하 등의 문제가 발생할 수 있습니다. <br />\n이러한 문제를 해결하기 위해 분할 업로드라는 기법을 사용할 수 있습니다. 분할 업로드란 파일을 작은 조각으로 나누어 업로드하는 방식입니다.\n<br />라이브러리를 사용하지 않고 Blob이라는 웹 API를 이용하여 파일을 슬라이스하는 방법과, axios를 이용하여 서버에 파일 조각을 보내고 받는 방법을 간략한 설명과 함께 작성해보겠습니다.</p>\n<h2>분할 업로드의 이점</h2>\n<p>분할 업로드 작업을 할 시에 아래와 같은 이점을 얻을 수 있습니다.</p>\n<ul>\n<li>업로드 시간을 단축할 수 있다. 파일을 조각으로 나누어 병렬로 업로드하면 전체적인 속도가 빨라진다.</li>\n<li>파일 업로드 중에 실패하더라도 다시 처음부터 업로드 하지 않고 실패한 부분부터 업로드한다.</li>\n<li>서버의 메모리 부하를 줄일 수 있다. 파일을 한 번에 받지 않고 조각으로 받으면 서버의 메모리 사용량을 줄일 수 있다.</li>\n</ul>\n<h2>예시 코드 작성</h2>\n<p>이제 파일을 분할 업로드하는 코드를 한번 작성해보겠습니다. <br />\n우선, 파일을 분할하는 함수를 작성하겠습니다. 이 함수는 전달받은 파일을 지정된 크기로 잘라서 Blob 배열로 반환합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">sliceFile</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">file<span class=\"token punctuation\">,</span> sliceSize</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> slices <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> start <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>start <span class=\"token operator\">&lt;</span> file<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> end <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>start <span class=\"token operator\">+</span> sliceSize<span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> slice <span class=\"token operator\">=</span> file<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">,</span> end<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    slices<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>slice<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    start <span class=\"token operator\">=</span> end<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> slices<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>다음으로, Blob 배열을 받아서 병렬로 업로드하는 함수를 만들어 줍니다. <br />\n이 함수는 각각의 Blob을 병렬로 업로드하고 모든 업로드가 완료되면 업로드된 파일의 URL 배열을 반환합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// FormData 객체에 파일 조각과 메타데이터 추가하는 함수</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">appendFormData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">formData<span class=\"token punctuation\">,</span> fileChunk<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">,</span> chunkIndex<span class=\"token punctuation\">,</span> chunkCount</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  formData<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'file'</span><span class=\"token punctuation\">,</span> fileChunk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 파일 조각</span>\n  formData<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fileName'</span><span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 파일 이름</span>\n  formData<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'chunkIndex'</span><span class=\"token punctuation\">,</span> chunkIndex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 파일 조각의 인덱스</span>\n  formData<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'chunkCount'</span><span class=\"token punctuation\">,</span> chunkCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 파일 조각의 개수</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Blob 배열을 받아서 병렬로 업로드하는 함수</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">uploadChunks</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">chunks<span class=\"token punctuation\">,</span> fileName</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> chunkCount <span class=\"token operator\">=</span> chunks<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> results <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">allSettled</span><span class=\"token punctuation\">(</span>\n    chunks<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">chunk<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// FormData 객체 생성</span>\n      <span class=\"token keyword\">const</span> formData <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FormData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// FormData에 파일 조각과 메타데이터 추가</span>\n      <span class=\"token function\">appendFormData</span><span class=\"token punctuation\">(</span>formData<span class=\"token punctuation\">,</span> chunk<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">,</span> chunkCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// axios로 서버에 POST 요청 보냄</span>\n        <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/upload'</span><span class=\"token punctuation\">,</span> formData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">'fulfilled'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> index <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">'rejected'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">reason</span><span class=\"token operator\">:</span> error <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> results<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>마지막으로, 업로드를 하고 실패할 경우 실패한 부분부터 재시도하는 함수를 작성해줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">uploadFile</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">file<span class=\"token punctuation\">,</span> sliceSize</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 파일의 크기와 이름</span>\n  <span class=\"token keyword\">const</span> fileSize <span class=\"token operator\">=</span> file<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> fileName <span class=\"token operator\">=</span> file<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 파일을 분할할 개수</span>\n  <span class=\"token keyword\">const</span> chunkCount <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>fileSize <span class=\"token operator\">/</span> sliceSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 파일을 분할하는 함수 호출</span>\n  <span class=\"token keyword\">const</span> chunks <span class=\"token operator\">=</span> <span class=\"token function\">sliceFile</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">,</span> sliceSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 서버에 GET 요청으로 업로드된 파일 조각의 인덱스 배열 받아옴</span>\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/uploaded'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">params</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> fileName <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> uploadedChunks <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 업로드할 파일 조각을 필터링하는 함수</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">filterChunks</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">chunks</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> chunks<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">chunk<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>uploadedChunks<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 업로드할 파일 조각을 필터링</span>\n  <span class=\"token keyword\">let</span> uploadChunks <span class=\"token operator\">=</span> <span class=\"token function\">filterChunks</span><span class=\"token punctuation\">(</span>chunks<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 업로드 결과를 저장할 배열</span>\n  <span class=\"token keyword\">let</span> results <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 업로드를 재시도하는 반복문</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>uploadChunks<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 병렬 업로드 함수 호출</span>\n    <span class=\"token keyword\">const</span> uploadResults <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">uploadChunks</span><span class=\"token punctuation\">(</span>uploadChunks<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 업로드 결과를 배열에 추가</span>\n    results <span class=\"token operator\">=</span> results<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>uploadResults<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 업로드에 실패한 파일 조각을 필터링</span>\n    uploadChunks <span class=\"token operator\">=</span> uploadResults\n      <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span> <span class=\"token operator\">=></span> result<span class=\"token punctuation\">.</span>status <span class=\"token operator\">===</span> <span class=\"token string\">'rejected'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span> <span class=\"token operator\">=></span> chunks<span class=\"token punctuation\">[</span>result<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 서버에 GET 요청으로 업로드된 파일 조각의 인덱스 배열 다시 받아옴</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/uploaded'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">params</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> fileName <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    uploadedChunks <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 업로드가 완료되었음을 알리는 메시지 출력</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Upload completed!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 파일 분할 업로드를 Blob의 Slice를 사용해서 구현해보았습니다. 라이브러리를 사용해서 쉽게 구현할 수 있지만 한번 직접 구현해보는 것도 과정을 이해하는데 도움이 될 거라고 생각합니다.</p>","frontmatter":{"title":"Blob의 Slice 메소드를 사용한 대용량 파일 분할 업로드","summary":"프론트에서 대용량 파일을 업로드할 때 Blob 메소드를 사용하여 파일을 분할 업로드하는 방법","date":"2023년 05월 06일","categories":["JS","Blob"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAgJBAf/xAAVAQEBAAAAAAAAAAAAAAAAAAAFBv/aAAwDAQACEAMQAAABrMt/QUvqBLDGUmlv/8QAGhAAAgMBAQAAAAAAAAAAAAAABAUCAwYHEv/aAAgBAQABBQLVz0BTLNzaNbEhVpqbpj9jl3SbpRXnPiWAIv/EAB0RAAICAgMBAAAAAAAAAAAAAAECAwQAEhETMXH/2gAIAQMBAT8BtJSaypsJYayvWazrasxpCY2EjMIo5liPap0k2Ql11DecYPB8z//EACMRAAEEAQMEAwAAAAAAAAAAAAMBAgQSEQATIQUUMkFRYXH/2gAIAQIBAT8BhdOnHigkxigHEEju5EohOWTuNUTUKrxXyEqXbV2F5a+41RNExuPr42dX8zx8evrX/8QAIxAAAgMAAQMEAwAAAAAAAAAAAwQBAgUTERIhAAYUMRUjMv/aAAgBAQAGPwI6GO+cAkcdXUMgoSqjGpzsay91xaNFG3FWYssrdPg4xFJUi7M8Z+8VQZSgMAiIE9VnZSl8Bc+3IQLOJpAbTIp7g2ZXC1UzmjSlGJKVqwFiAF8jIdPMSdzLz2jTERWJKwoIpJiseKxN7TMRHiPr0m8s67xaOOQEKLfiwQEua3YsnsdzI0ymhmHqV4v1QGV+6l55rRGrAFjpcxTMMfBvgLfKYtF+47Xb7WnmJbz3W61t5ntmsz19YyJGbN3Ty0FrNXGMVjyFUVOSRCiBj69P5r16R92tPW0//8QAFxABAQEBAAAAAAAAAAAAAAAAAREAIf/aAAgBAQABPyGPHAnO2JoXlimIr4upQPssew5IPOZOAyWOBqruO3rECl0cfhzdNMDRV0q6jOb/AKToACJIQYR//9oADAMBAAIAAwAAABCsD//EABoRAAIDAQEAAAAAAAAAAAAAAAERACExUXH/2gAIAQMBAT8QLGQtG0rUhkpSazUfqDdm3tkcJ2f/xAAXEQEBAQEAAAAAAAAAAAAAAAABESEA/9oACAECAQE/ENA1Ez4jRemzTBGHUBBtQIgYghCCDnf/xAAWEAEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQEAAT8QIIflpaW8Ag6VJAVZZT0J2OC3CbP2DRAAhAVMz57i8mMQjIJyRvoWc5iRQXH82Dny54ER/9k="},"images":{"fallback":{"src":"/static/4ad5fb66bf8fd7d5069873bd05a8e032/b9a3f/large_file.jpg","srcSet":"/static/4ad5fb66bf8fd7d5069873bd05a8e032/8c1e2/large_file.jpg 256w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/8d48d/large_file.jpg 512w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/b9a3f/large_file.jpg 1024w","sizes":"(min-width: 1024px) 1024px, 100vw"},"sources":[{"srcSet":"/static/4ad5fb66bf8fd7d5069873bd05a8e032/45285/large_file.webp 256w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/760b0/large_file.webp 512w,\n/static/4ad5fb66bf8fd7d5069873bd05a8e032/acd1d/large_file.webp 1024w","type":"image/webp","sizes":"(min-width: 1024px) 1024px, 100vw"}]},"width":1024,"height":685}},"publicURL":"/static/4ad5fb66bf8fd7d5069873bd05a8e032/large_file.jpeg"}}}}]},"file":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAUABQDASIAAhEBAxEB/8QAGgABAAMAAwAAAAAAAAAAAAAAAAQFBwIICf/EABYBAQEBAAAAAAAAAAAAAAAAAAIDAf/aAAwDAQACEAMQAAAB9samFlU6doUA51HExaMEf//EABsQAAIDAQEBAAAAAAAAAAAAAAIFAwQGARMi/9oACAEBAAEFAn7BtF1oiclXV2p7lGz6w6LNVLMLdF9p9InjawDks3wREQH/xAAbEQABBQEBAAAAAAAAAAAAAAABAhARIUFhgf/aAAgBAwEBPwFIqZSIu94eNg9b/8QAGxEAAgIDAQAAAAAAAAAAAAAAASEQEUFxgeH/2gAIAQIBAT8BJdNmtexk8j//xAAlEAACAgIBBAICAwAAAAAAAAACAwEEBRETABIUIQYiIzEyQVH/2gAIAQEABj8Cq0Pj9evYydh9Y3lantr0MTNoE3bxfYOVwiUjVriUkxm2SBrSYzasYf5DkE5s0JCu241TcVBhKRaZYvxTqDyrFpfjVBwxn1MY1pDrKYTa/Im2oN8YWqrmVrPF3TJSiXqMq5F9iTKyL3M9ZS3VGDyAYSAmqRzLrOOASdRbST/FpIyo36zVbD3cURsjvUJ1GeDxhQS2ni02cfexkY/HWVV5sUUTeEVd7W11s46oB9FKCVzCWHNB87graIvN3vfNfmbjv3/jXnG/7iNx610gvMvY+xXYxSrePYgHwjIL8G4ifJr2kytymQXtPIt6UPSa2Kguu0sPTbI9sCywE2HhxzHbK3vljkzsYLajCZmN9CADAAEQIiMQIiIxoRGI9RERGoiPUR1//8QAGBABAQEBAQAAAAAAAAAAAAAAAREAITH/2gAIAQEAAT8heI5/xCL6xdS/QnrkUaRG5hFplj5gRtmuZYCbud8Tj4PHy2ky22IUWr34DavOkL4AF7SsBUBBjVuMMy6TbcJKpAbbUxaLRpJx9o/iCIHhgAABv//aAAwDAQACAAMAAAAQFPgA/8QAGxEBAAIDAQEAAAAAAAAAAAAAAREhADFxEJH/2gAIAQMBAT8QFQgaAVsLIwaBUJK3WNL1xUjUvRTSJ8VTvn//xAAcEQEBAAICAwAAAAAAAAAAAAABESExAFEQcZH/2gAIAQIBAT8QmELcFACFIXZXNITE4aPRwBuDjYuxH6APYHXj/8QAFxABAQEBAAAAAAAAAAAAAAAAAREAIf/aAAgBAQABPxCX/FfjeibBnSlMyEvCdnXXdYGOOCBIkByZBL7Wk9AGI2YDYxBV33YyIdV6CrQr9/nTKCI2gC5SZiNz+gyXY06QsciQhqamF4bZmFgH/9k="},"images":{"fallback":{"src":"/static/ae91b527e5e44c319ca3c0dc2a238c15/c3a8c/profile-image.jpg","srcSet":"/static/ae91b527e5e44c319ca3c0dc2a238c15/2e59f/profile-image.jpg 11w,\n/static/ae91b527e5e44c319ca3c0dc2a238c15/ef9f5/profile-image.jpg 23w,\n/static/ae91b527e5e44c319ca3c0dc2a238c15/c3a8c/profile-image.jpg 45w,\n/static/ae91b527e5e44c319ca3c0dc2a238c15/936b0/profile-image.jpg 90w","sizes":"(min-width: 45px) 45px, 100vw"},"sources":[{"srcSet":"/static/ae91b527e5e44c319ca3c0dc2a238c15/0513d/profile-image.webp 11w,\n/static/ae91b527e5e44c319ca3c0dc2a238c15/31868/profile-image.webp 23w,\n/static/ae91b527e5e44c319ca3c0dc2a238c15/85c56/profile-image.webp 45w,\n/static/ae91b527e5e44c319ca3c0dc2a238c15/be9e0/profile-image.webp 90w","type":"image/webp","sizes":"(min-width: 45px) 45px, 100vw"}]},"width":45,"height":45}}}},"pageContext":{"slug":"/large_file/"}},"staticQueryHashes":[],"slicesMap":{}}